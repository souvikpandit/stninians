var updateOutput=function(t){var e=t.length?t:$(t.target),a=e.data("output");window.JSON?a&&a.val(window.JSON.stringify(e.nestable("serialize"))):alert("JSON browser support required for this page.")},nestableList=$("#nestable > .dd-list"),deleteFromMenuHelper=function(t){1==t.data("new")?t.fadeOut(function(){t.remove(),updateOutput($("#nestable").data("output",$("#json-output")))}):(t.appendTo(nestableList),t.data("deleted","1"),t.fadeOut())},deleteFromMenu=function(){var t=$(this).data("owner-id"),e=$('[data-id="'+t+'"]'),a=confirm("Delete "+e.data("name")+" and all its subitems ?");a&&(e.find("li").each(function(){deleteFromMenuHelper($(this))}),deleteFromMenuHelper(e),updateOutput($("#nestable").data("output",$("#json-output"))))},menuEditor=$("#menu-editor"),editButton=$("#editButton"),editInputName=$("#editInputName"),editInputSlug=$("#editInputSlug"),currentEditName=$("#currentEditName"),prepareEdit=function(){var t=$(this).data("owner-id"),e=$('[data-id="'+t+'"]');editInputName.val(e.data("name")),editInputSlug.val(e.data("slug")),currentEditName.html(e.data("name")),editButton.data("owner-id",e.data("id")),console.log("[INFO] Editing Menu Item "+editButton.data("owner-id")),menuEditor.fadeIn()},editMenuItem=function(){var t=$(this).data("owner-id"),e=$('[data-id="'+t+'"]'),a=editInputName.val(),n=editInputSlug.val();e.data("name",a),e.data("slug",n),e.find("> .dd-handle").html(a),menuEditor.fadeOut(),updateOutput($("#nestable").data("output",$("#json-output")))},newIdCount=1,addToMenu=function(){var t=$("#addInputName").val(),e=$("#addInputSlug").val(),a="new-"+newIdCount;nestableList.append('<li class="dd-item" data-id="'+a+'" data-name="'+t+'" data-slug="'+e+'" data-new="1" data-deleted="0"><div class="dd-handle">'+t+'</div> <span class="button-delete btn btn-default btn-xs pull-right" data-owner-id="'+a+'"> <i class="fa fa-times-circle-o" aria-hidden="true"></i> </span><span class="button-edit btn btn-default btn-xs pull-right" data-owner-id="'+a+'"><i class="fa fa-pencil" aria-hidden="true"></i></span></li>'),newIdCount++,updateOutput($("#nestable").data("output",$("#json-output"))),$("#nestable .button-delete").on("click",deleteFromMenu),$("#nestable .button-edit").on("click",prepareEdit)};$(function(){updateOutput($("#nestable").data("output",$("#json-output"))),editButton.on("click",editMenuItem),$("#nestable .button-delete").on("click",deleteFromMenu),$("#nestable .button-edit").on("click",prepareEdit),$("#menu-editor").submit(function(t){t.preventDefault()}),$("#menu-add").submit(function(t){t.preventDefault(),addToMenu()})});